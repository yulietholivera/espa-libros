import{o as e,t as g,a as x,w}from"./chunk-QMGIS6GS-ClXNqF_9.js";import{L as b}from"./logo-D5a0bzcX.js";import{u as A}from"./CartContext-CTEwtsR9.js";import"./auth-BPhwfanI.js";function C(){const{totalItems:t}=A();return e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(g,{to:"/",children:e.jsx("img",{src:b,alt:"Espa-Libros Logo",className:"h-14"})}),e.jsxs("nav",{className:"flex space-x-4",children:[e.jsxs(g,{to:"/carrito","aria-label":"Ver carrito",className:"relative",children:[" ",e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"48",height:"48",fill:"url(#pattern-cart)"}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"pattern-cart",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:e.jsx("use",{xlinkHref:"#image-cart",transform:"scale(0.0208333)"})}),e.jsx("image",{id:"image-cart",width:"48",height:"48",preserveAspectRatio:"none",xlinkHref:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADGElEQVR4Ae3BP2hUdwAA4O/9kkHkBguROhSaQSRgoIEWclAhD3rgbS5dpEuGgBTERRcJkhQdAurmYCHgUoSCoxSHB71AhhMcKiicVOEcKhYC3hBCIAEb+AUSvT/vLrW5O+j3JXiv2Y+4awgEraWGROJDJ/EnGvjMEAg+9BKvcQzfGAJBs0xUMgSCZpkoNQSCZploBkcMuKDZGp7iCIoGXNDaI1HZgAtaq4hSA25Ua6vYxDSOoWHPe4PjeNDaOh6LSgZTA2uj2sswgxIe2JPorxS/44UdQXuZaMZgmRT9YUfQ3hM0MIFxg2NCVLMjaG8bK6LU4JgSvbQj6OyRqGwwjOIr0aodQWcV0YzBMIkCXqBhR9BZDX/hBKb03xlR1a4gXyYq6b+i6IldQb5MVNJ/Z0WZXUG+TPQtRvVPEWN4jZpdQb63eI4CzuifsuihfYLuZKJU/5wTPbRP0J1HorL+mMAUGqjYJ+jOKrbxNQoO36zoV2zaJ+jOOh5jFCWHaxQ/iH7xkaB7majkcJXxBV5h1UeC7mWi7xyui6K7Wgi6V8U6JnDC4ZjCWWxiWQtB97axIio7HIuin9HQQtCbTJT6753BOWxiSRsjetPARZzECDbwxqdVxCxuooCf8Js2Er17htP2rKOGZ3iOGtZRF61jTTSGgmgcBUzgNCYxgYI9T1HEpjYSB1PC9yjjS5/WK2R4gEyOxL83hiImMY6TGMMxfI4jPrSJv9HAW9RRxzNUseZ/QyRxcCkuoyiq4jYqepPiMoqiKm6joguJg1nEgtau4YbuLGJBa9dwQ44RvUtxD9uYx3ncxDukKGEFdZ2luIdtzOM8buIdUpSwgroORvTuDk5hHkvYwAZWsYUSjuO+zu7gFOaxhA1sYBVbKOE47usg6N20aFmzZdG0fNOiZc2WRdNyBL1L5EvkS+RL5Ah6VxXNaTYnqspXFc1pNieqyjGid28wixRbqOEoLuE6Ai6grrM3mEWKLdRwFJdwHQEXUNdB4mAWsaC1q1jSnUUsaO0qluRIHFyKKyiKqriFit6kuIKiqIpbqOjCP8N7run6DvR6AAAAAElFTkSuQmCC"})]})]}),t>0&&e.jsx("span",{className:"absolute top-1 right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white",children:t>99?"99+":t})]}),e.jsx(g,{to:"/panel-crud","aria-label":"Panel CRUD",children:e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"48",height:"48",fill:"url(#pattern-panel)"}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"pattern-panel",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:e.jsx("use",{xlinkHref:"#image-panel",transform:"scale(0.0208333)"})}),e.jsx("image",{id:"image-panel",width:"48",height:"48",preserveAspectRatio:"none",xlinkHref:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADb0lEQVR4Ae3BT2jVdQAA8M/79T1M2GHQwlEaAw3eYYdB89SkCQsXCE2YVCR0UXjHDkaGgo2MCAmTLTQ8aDhR2KACQQ8DFz5okYLDRR40Rk140oIdHvQOKxO+wny8v9seugd+Pp55ylKKdaDF+pbHgkdSok6Mo0dzyOJdzKdEV7ATefxtfXserchiexDtFG3GovWtHX+h10OJYovWvwWPSTS5xPrWjkFVBCuXxja8iN/xE+atzCBuYk5lbbiGNLYjq4ygfu/gCNJKZfExsmr7AMexiD2YVCpgHGnM4LoKErUFnMYFpHEff4hmkUcvruKg6npwTNSGy8goNYJ+5LALBRUkahvBPuSxH5twVfQlXsAXos+RUV4bxhFwAsMIOImTCKIMMihgN+ZVEVQ3gAzyeBNZpQo4iFmcwwgmcUexM+jEDRzAEu7gNDLYim8wItqPaTUkqjssGkZWdWP4FgEHFGvHIBYxhCXRGHYgh36MI+AzjKlDorI2vIYCRtXnK9Fbii3gDWzHnGLT2IYZ0Q84rE5BZV2iGygo7yO8r1QHWpG3bFJl8+jFAC5ZgaCyIFpSal6URlp5WzCjfnlMWKGgskXRRqWOYlKpFlwWzaisHWdwHhetQVDZLBaRRhq3LStgSqkh0c+q68IubMBFa5CobAnnRSNqa8WnojH1CaJu3EK/FUpUdxQL6MdJBOW1Yhxp/IpTirXgGkaVN4gu9Ir24jd0qSFRXQ57UEAGv2AvOkSdyOAWBpDDIJYU60AvdqlPP9LoUUNQ2xR2YBzdOKe8GxjCnCcoqM80XsE+DCGNjbiHm7iIMU9BUL8CRjFq5XKYwbRoDndxSTSFfbgpmkI/rqsheDIK6LZsDlstm8Imy87irDokmlyiyQXF+jSZoNhVTSYo9qPm8LpHgmJ9msMDjySaXKL5BI8Jont4Cd9hxvr2quiuh1KiQVxAi+awhN24lLKsEwPosHoBh0TDih0RDVubHKZw20PBsjmcsjZdOIS7+ESxvdiCCcxqkERjDYiySk2LBjRQorHeE11R6orobQ2UaJw+dCOH75WaQA496NMgicZowYjoBApKFfC16DhaNEDK6g3hmKgV7XiAP/Gf8hJsRgoLyIs+xIRVCFYvjU7FUnhZfdrRLtpqlVLWplP0HDYgrz6t+Af/iuY806T+BzBzyJlh+HqwAAAAAElFTkSuQmCC"})]})]})}),e.jsx(g,{to:"/login","aria-label":"Iniciar sesión",children:e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"48",height:"48",fill:"url(#pattern-login)"}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"pattern-login",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:e.jsx("use",{xlinkHref:"#image-login",transform:"scale(0.0208333)"})}),e.jsx("image",{id:"image-login",width:"48",height:"48",preserveAspectRatio:"none",xlinkHref:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAExUlEQVR4Ae3BUWhdZwEA4O/ee5ApV+lD6A5asLiAB9OH2JXiQw0eGKW2Eco8hFtaXdA5HRahyKZFsBT1aXvYQ0FkioN2nIzuRhkbWtm4m1UIGlkqtR7kTjKZ5QxSzSBikUOxcAJ/r6mpSG4awe/zf3dZw9YW4TiOoo15nMRbVjVsXRFyZAYt4aN4y00tW1OEHBlKfAqPYQzjuBezbmraeiLkyFAixatYwrTaHquatpYIOTKUSFEIdqmtWNW0dUTIkaFEikKQIFc7Z1XT1hAhR4YSKQpBgh5idHHGqoa7L0KODCVSFIIEPcToooPKqqa7K0KODCVSFAY9iRh9dFC5RcvdEyFHhhIpCmv9CVOI8T5ccIuWuyNCjgwlUhSCUTyCBfRxEVOYwDZcsKpl80XIkaFEikKQ4DUcxgTOo4+LmMIEtuGCm1o2V4QcGUqkKAQJeohxHR/CBM6jj4uYwgTei5+1bJ4IOTKUSFEIRvEaYnRxCAexGxM4jz4+gL3Yje+0bI4IOTKUSFEY9FlkqHAEfXQxid2YwL04iQpHcaVl+CLkyFAiRWGteYxhFx7ES1hEF5PYjQdQ4Qied1PLcEXIkaFEikKQ4Cz+hiuYxRj2IsNLWEQXk9iGI3jeqpbhiZAjQ4kUhSBBD+PI8HtcxizGsBcZnsNVPIuz+LlbNA1HhBwZSqQoBAl6iHEJEXJkqDCnFiNWW0bhX7RsvAg5MpRIUQgS9BCji/34Kw7iQdyHx9ROYNY6WjZWhBwZSqQoBAl6iNFFBxXm8A4OYlztBJ5yBy0bJ0KODCVSFIIEPcToooNKMId38AC+iqf8BxrWF2ESh7APidoy+ijwPcwhR4YSKQpBgh5idNFBZQM0/HvT+AZG3dkSRlAiRSFI0EOMLjqobJCGtdr4ITK1S5jBT3EZFUawEwfwZcQokaIQJOghRhcdVDZQw6A2foJ9WMajmLG+CJNYwKIgQQ8xuuigssEaBp1HhkWkWPTfSdBDjC46qAxBJDiGDMv4JBYNijCONlawgMpaO9FDjC46qAxJpHYPnlA7gcKg4ziFEcESTuOMQeOIsYwOKkPUUsswjUv4kkE5Hsd78DZ+g3djOw5iFD8S9HEU78ev8QdD1FL7NhKcxrzgOB7HCh7CNJ7Bk3gD+7EH1/ArtRt4F/bj73jBEDXV7ld7WRDhlNoXMGPQOTyqdsqgl9X2GbKm2g61vmAcI3gbM27vHK5hBHsEC2r3GbKm4LpBbbXC+i6rta0VGbImIrXIoBW1D1vfmNqKoK123ZA1UeHPiDAqWMASYnTc3jGMYAnzglG1Nw1ZU21O7ROCCqfVnsYxg47hu2qnDTqg9gtDFqn9GJ/GQ/i+4Aw+hqM4iydQIEGs9izOCCJ8Xu1FQ9ZS+yM+h4/gd7gimMU17MV27EQbS/gavm7QFB7BG/gKbhiihuBhPI0SH0ffoAjjaGMF89Yaxeto4zM4Z8hagt/ifuzGflzAXwQ3cBWLuGqtBK9gBM/hmzZBS3ADL+AQdmEKb+KKO5vGeWzHLzGFf9gEDWu1MYNDanP4AV5FX7ATB/BFjKt1MY0Vm6Th9iJM41uIBRVK7DCoxEk8Y5M1rK+NwziMPfigYAmv4EXMoPI/4B7ssIX8E25DQ1oamg57AAAAAElFTkSuQmCC"})]})]})})]})]})})}function B({onSearch:t}){const[i,a]=x.useState(""),n=s=>{a(s.target.value)},o=s=>{s.key==="Enter"&&t(i.trim())};return e.jsxs("div",{className:"relative mb-6 max-w-lg mx-auto",children:[e.jsx("input",{type:"search",value:i,onChange:n,onKeyDown:o,placeholder:"Buscar libros…","aria-label":"Buscar libros",className:`w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400
                   focus:outline-none focus:ring-2 focus:ring-regal-espalibros focus:border-regal-espalibros`}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"})})})]})}function v({loading:t,error:i}){return t?e.jsx("div",{className:"py-8 text-center text-lg text-gray-700",children:"Cargando libros…"}):i?e.jsxs("div",{className:"py-8 text-center text-lg text-red-600",children:["Error: ",i]}):null}function E({error:t}){return e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("p",{className:"text-lg font-medium text-red-600",children:"¡Vaya! Ha ocurrido un error:"}),e.jsx("p",{className:"mt-2 text-sm text-red-500",children:t})]})}function y({text:t}){return e.jsx("div",{className:"md:flex md:items-center md:justify-between my-6",children:e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-gray-700 underline",children:t})})}function N({libro:t}){var o;const{addToCart:i}=A(),n=(o=t.imagenURL)!=null&&o.startsWith("http")?t.imagenURL:`https://mi.dominio.com/api${t.imagenURL}`;return e.jsxs("div",{className:"group relative mb-5",children:[e.jsxs(g,{to:`/libros/${t._id}`,children:[e.jsx("div",{className:"w-full h-55 overflow-hidden bg-gray-200 group-hover:opacity-75",children:e.jsx("img",{src:n,alt:t.titulo,className:"w-full h-full object-cover",onError:s=>{s.currentTarget.src="https://via.placeholder.com/150x220.png?text=No+Imagen"}})}),e.jsx("h3",{className:"mt-1 text-sm text-gray-700",children:t.titulo})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>i(t),className:`rounded-sm bg-regal-espalibros px-2 py-1 text-xs font-semibold text-white shadow-xs
                       hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-600`,children:"Comprar"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["$",t.precio]})]})]})}function R({libros:t}){return t.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No se encontraron libros."}):e.jsx("div",{className:"mt-6 grid grid-cols-2 gap-x-5 gap-y-10 sm:gap-x-6 md:grid-cols-5 md:gap-y-0 lg:gap-x-8",children:t.map(i=>e.jsx(N,{libro:i},i._id))})}function S({currentPage:t,totalPages:i,onPageChange:a}){const o=(()=>{const s=[];let r=Math.max(1,t-2),l=Math.min(i,t+2);r>1&&(s.push(1),r>2&&s.push("..."));for(let c=r;c<=l;c++)s.push(c);return l<i&&(l<i-1&&s.push("..."),s.push(i)),s})();return e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-xs bg-regal3-espalibros","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>a(t-1),disabled:t===1,className:"relative border border-gray-500 inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 hover:bg-gray-50 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx("svg",{className:"h-5 w-5 text-gray-900",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"})})]}),o.map((s,d)=>s==="..."?e.jsx("span",{className:"relative border border-gray-500 inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"…"},`ellipsis-${d}`):e.jsx("button",{onClick:()=>a(s),"aria-current":s===t?"page":void 0,className:`relative border border-gray-500 inline-flex items-center px-4 py-2 text-sm font-semibold ${s===t?"bg-regal-espalibros text-white z-10":"text-gray-900 hover:bg-gray-50"}`,children:s},s)),e.jsxs("button",{onClick:()=>a(t+1),disabled:t===i,className:"relative border border-gray-500 inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 hover:bg-gray-50 disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx("svg",{className:"h-5 w-5 text-gray-900",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})})]})]})}function I(){const[t,i]=x.useState([]),[a,n]=x.useState(!0),[o,s]=x.useState(null);return x.useEffect(()=>{async function d(){n(!0),s(null);try{const r=await fetch("/api/libros");if(!r.ok)throw new Error(`Error al contactar el servidor: ${r.status}`);const l=await r.json();i(l.libros)}catch(r){console.error("Error en fetchLibros:",r),s(r.message||"No se pudieron cargar los libros.")}finally{n(!1)}}d()},[]),{libros:t,loading:a,error:o}}const Y=w(function(){const{libros:i,loading:a,error:n}=I(),[o,s]=x.useState(""),[d,r]=x.useState(1),l=i.filter(h=>h.titulo.toLowerCase().includes(o.toLowerCase())),c=25,m=Math.ceil(l.length/c),u=(d-1)*c,p=l.slice(u,u+c),j=h=>{s(h),r(1)},f=h=>{r(h)};return e.jsx("div",{className:"bg-regal2-espalibros min-h-screen",children:e.jsxs("div",{className:"mx-auto max-w-4xl px-4 py-16 sm:px-6 sm:py-24 lg:px-8",children:[e.jsx(C,{}),e.jsx(B,{onSearch:j}),e.jsx(v,{loading:a,error:n}),!a&&n&&e.jsx(E,{error:n}),!a&&!n&&e.jsxs(e.Fragment,{children:[e.jsx(y,{text:"Libros más leídos de la semana"}),e.jsx(R,{libros:p}),m>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx(S,{currentPage:d,totalPages:m,onPageChange:f})})]})]})})});export{Y as default};
